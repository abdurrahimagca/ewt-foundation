<?xml version="1.0" encoding="utf-8" ?>
<entities xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://raw.githubusercontent.com/shopware/shopware/trunk/src/Core/System/CustomEntity/Xml/entity-1.0.xsd">

    <entity name="ce_travel_order_info">
        <fields>
            <text name="identifier_code" store-api-aware="true" />
            <one-to-many name="travellers" store-api-aware="true" reference="ce_traveller" on-delete="cascade"/>
            <one-to-one name="flight_info" store-api-aware="true" reference="ce_flight_info" on-delete="cascade"/> 
            <one-to-one store-api-aware="true" name="order" reference="order" on-delete="cascade"/>
            <one-to-one name="bundle_info" store-api-aware="true" reference="ce_travel_order_bundle_info" on-delete="cascade"/>
        </fields>
    </entity>

    <entity name="ce_traveller">
        <fields>
            <text name="name" store-api-aware="true" />
            <text name="surname" store-api-aware="true" />
            <date name="birthdate" store-api-aware="true" />
            <email name="email" store-api-aware="true" />
            <text name="phone" store-api-aware="true" />
            <text name="passport_number" store-api-aware="true" />
        </fields>
    </entity>

    <entity name="ce_flight_info">
        <fields>
            <date name="arrival_date" store-api-aware="true" />
            <date name="return_date" store-api-aware="true" />
            <text name="arrival_airport" store-api-aware="true" />
            <text name="departure_airport" store-api-aware="true" />
            <text name="airline" store-api-aware="true" />
            <text name="flight_number" store-api-aware="true" />
        </fields>
    </entity>

    <entity name="ce_travel_order_bundle_info">
        <fields>
            <one-to-many name="rooms" reference="ce_travel_order_bundle_info_room_selection" store-api-aware="true" on-delete="set-null" />
            <one-to-many name="additional_products" reference="product" store-api-aware="true" on-delete="set-null" />
        </fields>
    </entity>

    <entity name="ce_travel_order_bundle_info_room_selection">
        <fields>
            <text name="room_name" store-api-aware="true" />
            <int name="number_of_adults" store-api-aware="true" />
            <int name="number_of_children" store-api-aware="true" />     
            <int name="room_quantity" store-api-aware="true" />
        </fields>
    </entity>

    <entity name="ce_travel_product_config">
        <fields>
            <one-to-one name="product" store-api-aware="true" reference="product" on-delete="cascade"/>
            <one-to-many name="bundles" store-api-aware="true" reference="ce_bundle" on-delete="cascade"/>
            <one-to-one name="child_discount" reference="ce_child_discount" store-api-aware="true" on-delete="cascade" />
        </fields>
    </entity>

    <entity name="ce_bundle">
        <fields>
            <one-to-one name="bundle_product" store-api-aware="true" reference="product" on-delete="cascade"/>
            <one-to-one name="rules" store-api-aware="true" reference="ce_sale_rules" on-delete="cascade"/>
            <one-to-one name="hotel_bundle" store-api-aware="true" reference="ce_hotel_bundle" on-delete="cascade"/>
        </fields>
    </entity>

    <entity name="ce_hotel_bundle">
        <fields>
            <int name="min_room_selection" store-api-aware="true" />
            <int name="max_room_selection" store-api-aware="true" />
            <one-to-many name="rooms" reference="ce_room_bundle" store-api-aware="true" on-delete="set-null" />
        </fields>
    </entity>

    <entity name="ce_room_bundle">
        <fields>
            <one-to-one name="room" store-api-aware="true" reference="product" on-delete="cascade"/>
            <one-to-many name="room_extra" store-api-aware="true" reference="product" on-delete="cascade"/>
            <one-to-one name="room_rules" store-api-aware="true" reference="ce_room_rules" on-delete="cascade"/>
        </fields>
    </entity>


    <entity name="ce_room_rules">
        <fields>
            <int name="min_adults" store-api-aware="true" />
            <int name="max_adults" store-api-aware="true" />
            <int name="min_children" store-api-aware="true" />
            <int name="max_children" store-api-aware="true" />
            <one-to-one name="supplement" reference="ce_room_supplement" store-api-aware="true" on-delete="set-null" />
        </fields>
    </entity>

    <entity name="ce_room_supplement">
    
    <fields>
        <text name="supplement_name" store-api-aware="true" />
        <int name="apply_if_adults" store-api-aware="true" />
        <int name="apply_if_children" store-api-aware="true" />
        <one-to-one name="supplement_product" reference="product" store-api-aware="true" on-delete="set-null" />
    </fields>
    </entity>

    <entity name="ce_sale_rules">
        <fields>
            <text name="rule_name" store-api-aware="true" />
            <text name="rule_description" store-api-aware="true" />
            <int name="min_quantity_against_parent_product_quantity" store-api-aware="true" />
            <int name="valid_from_parent_product_quantity" store-api-aware="true" />
            <int name="max_quantity_against_parent_product_quantity" store-api-aware="true" />
        </fields>
    </entity>

    <entity name="ce_child_discount">
        <fields>
            <float name="discount_percentage" store-api-aware="true" />
            <int name="apply_on_quantity" store-api-aware="true" />
            <int name="apply_to_quantity" store-api-aware="true" />         
        </fields>
    </entity>

</entities>
